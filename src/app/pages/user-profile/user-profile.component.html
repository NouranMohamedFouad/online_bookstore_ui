<div class="container-fluid">
  <div class="row">
    <div class="col-md-3 sidebar">
      <h5 class="text-muted">MY ACCOUNT</h5>
      <ul class="list-group list-group-flush">
        <li class="list-group-item" [ngClass]="{'active': selectedSection === 'profile'}" (click)="switchSection('profile')">
          <a class="text-light text-decoration-none">Profile</a>
        </li>
        <li class="list-group-item" [ngClass]="{'active': selectedSection === 'addresses'}" (click)="switchSection('addresses')">
          <a class="text-light text-decoration-none">Addresses</a>
        </li>
        <li class="list-group-item" [ngClass]="{'active': selectedSection === 'password'}" (click)="switchSection('password')">
          <a class="text-light text-decoration-none">Password</a>
        </li>
      </ul>
    </div>

    <div class="col-md-9">

      @if (selectedSection === 'profile') {
        <div class="profile-container">
          <h4 class="personal">Personal Information</h4>
          <form (ngSubmit)="updateProfile()">
            <div class="row">
              <div class="col-md-6">
                <label for="name" class="form-label">Name</label>
                <input type="text" class="form-control" id="name" [(ngModel)]="user.name" name="name">
              </div>
              <div class="col-md-6">
                <label for="email" class="form-label">Email</label>
                <input type="text" class="form-control" id="email" [(ngModel)]="user.email" name="email" readonly>
              </div>
              <div class="col-md-6">
                <label for="phone" class="form-label">Phone</label>
                <input type="text" class="form-control" id="phone" [(ngModel)]="user.phone" name="phone">
              </div>
            </div>
            <div class="d-flex justify-content-between mt-4">
              <button type="submit" class="btn btn-update">UPDATE PROFILE</button>
              <button type="button" class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#deleteModal">
                Delete my account
            </button>
            <div class="modal fade" id="deleteModal" tabindex="-1" aria-labelledby="deleteModalLabel" aria-hidden="true">
              <div class="modal-dialog modal-dialog-centered">
                  <div class="modal-content">

                      <div class="modal-header bg-danger text-white">
                          <h5 class="modal-title" id="deleteModalLabel">Confirm Account Deletion</h5>
                          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                      </div>


                      <div class="modal-body">
                          <p class="mb-0">Are you sure you want to delete your account? This action <strong>cannot</strong> be undone.</p>
                      </div>


                      <div class="modal-footer">
                          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                          <button type="button" class="btn btn-danger" (click)="confirmDelete()" [disabled]="isDeleting">
                                @if (isDeleting) {
                                <span class="spinner-border spinner-border-sm"></span>
                                }
                              Delete
                          </button>
                      </div>
                  </div>
              </div>
            </div>
            </div>
          </form>
        </div>
      }

      @if (selectedSection === 'addresses') {
        <div class="profile-container">
          <h4 class="personal">Addresses</h4>
          <form (ngSubmit)="updateProfile()">
            <div class="row">
              <div class="col-md-6">
                <label for="street" class="form-label">Street</label>
                <input type="text" class="form-control" id="street" [(ngModel)]="user.address.street" name="street">
              </div>
              <div class="col-md-6">
                <label for="city" class="form-label">City</label>
                <input type="text" class="form-control" id="city" [(ngModel)]="user.address.city" name="city">
              </div>
              <div class="col-md-6">
                <label for="buildingNo" class="form-label">Building Number</label>
                <input type="number" class="form-control" id="buildingNo" [(ngModel)]="user.address.buildingNo" name="buildingNo">
              </div>
              <div class="col-md-6">
                <label for="floorNo" class="form-label">Floor Number</label>
                <input type="number" class="form-control" id="floorNo" [(ngModel)]="user.address.floorNo" name="floorNo">
              </div>
              <div class="col-md-6">
                <label for="flatNo" class="form-label">Flat Number</label>
                <input type="number" class="form-control" id="flatNo" [(ngModel)]="user.address.flatNo" name="flatNo">
              </div>
            </div>
            <button type="submit" class="btn btn-update mt-4">UPDATE Address</button>
          </form>
        </div>
      }

      @if (selectedSection === 'password') {
        <div class="profile-container">
          <h4 class="personal">Change Password</h4>
          <form (ngSubmit)="updatePassword()">
            <div class="row">
              <div class="col-md-6">
                <label for="oldPassword" class="form-label">Old Password</label>
                <input type="password" class="form-control" id="oldPassword" [(ngModel)]="user.oldPassword" name="oldPassword">
              </div>
              <div class="col-md-6">
                <label for="newPassword" class="form-label">New Password</label>
                <input type="password" class="form-control" id="newPassword" [(ngModel)]="user.newPassword" name="newPassword">
              </div>
              <div class="col-md-6">
                <label for="confirmPassword" class="form-label">Confirm New Password</label>
                <input type="password" class="form-control" id="confirmPassword" [(ngModel)]="user.confirmPassword" name="confirmPassword">
              </div>
            </div>
            <button type="submit" class="btn btn-update mt-4">UPDATE Password</button>
          </form>
        </div>
      }

  </div>
</div>
